<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>CMS Login</title>
    <style>
      body { display: flex; align-items: center; justify-content: center; height: 100vh; font-family: sans-serif; }
      form { display: flex; flex-direction: column; gap: 0.5rem; width: 300px; }
      input { padding: 0.5rem; }
      button { padding: 0.5rem; }
    </style>
  </head>
  <body>
    <form id="loginForm">
      <input id="username" type="text" placeholder="Username" required />
      <input id="password" type="password" placeholder="Password" required />
      <button type="submit">Login</button>
    </form>
    <script>
      const form = document.getElementById('loginForm');
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const username = (document.getElementById('username') as HTMLInputElement).value;
        const password = (document.getElementById('password') as HTMLInputElement).value;
        const token = btoa(`${username}:${password}`);
        try {
          const res = await fetch('/admin/index.html', { headers: { 'Authorization': 'Basic ' + token } });
          if (!res.ok) throw new Error('Invalid credentials');
          localStorage.setItem('cmsAuth', token);
          const html = await res.text();
          document.open();
          document.write(html);
          document.close();
        } catch (err) {
          alert('Login failed');
        }
      });
    </script>
  </body>
</html>
